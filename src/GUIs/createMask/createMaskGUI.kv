#kivy 1.10.0
#:import split os.path.split
MainContainer:

<MainContainer>:
    padding: root.width * .02, root.height * .02
    spacing: "10dp"
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    orientation: 'vertical'
    ### Logo Box --------------------------------------------------
    BoxLayout:
        size_hint: (1, None)
        height: 200
        Image:
            allow_stretch: True
            source: root.setupGUI_dir + '/images/createMaskLogo.png'

    ### Func Image --------------------------------------------------
    BoxLayout:
        id: subjFuncWidget
        padding: [10, 5]
        spacing: 10
        size_hint: (1, .8)
        Label:
            size_hint_x: .3
            text_size: self.size
            color: root.textColor
            text: '4D FUNC: '
            halign: 'right'
            valign: 'middle'
        FilePathInputField:
            multiline: False
            id: subjFuncInput
            size_hint_x: .7
            text: root.GUI_settings.subjFunc
            halign: 'left'
            on_text: root.GUI_settings.subjFunc = subjFuncInput.text
            write_tab: False
            font_size: 28
            padding: [15,15]
        Button:
            id: 'subjFuncButton'
            size_hint: (None, None)
            size: (65,65)
            spacing: 15
            padding: (15,15)
            background_normal: root.setupGUI_dir + '/images/openFileBrowser.png'
            allow_stretch: False
            on_release: root.launchFileBrowser(loadFunc=root.setFuncFile)
    Widget:
        id: separator
        size_hint_y: None
        height: 3
        canvas:
            Color:
                rgb:.5, 0.5, 0.5
            Rectangle:
                pos: 50, separator.center_y
                size: separator.width-60, 2


    ### Create Whole Brain Mask Option
    BoxLayout:
        CheckBox:
            halign: 'left'
            id: createFuncBrainMaskCheckbox
            state: 'down' if root.GUI_settings.createFuncBrainMask else 'normal'
            on_active: root.setCreateFuncBrainMask()
        Label:
            text: 'Create FUNC whole-brain mask'
            color: root.textColor if createFuncBrainMaskCheckbox.active else root.disabledTextColor
            halign: 'left'
        BoxLayout:
            size_hint_x: 1.23

    Widget:
        id: separator
        size_hint_y: None
        height: 3
        canvas:
            Color:
                rgb:.5, 0.5, 0.5
            Rectangle:
                pos: 50, separator.center_y
                size: separator.width-60, 2

    ### Transform MNI mask to FUNC
    BoxLayout:
        CheckBox:
            halign: 'left'
            id: transformMaskToFuncCheckbox
            state: 'down' if root.GUI_settings.transformMaskToFunc else 'normal'
            on_active: root.setTransformMaskToFunc()
        Label:
            text: 'Transform MNI mask to FUNC'
            color: root.textColor if transformMaskToFuncCheckbox.active else root.disabledTextColor
            halign: 'left'
        BoxLayout:
            size_hint_x: 1.23

    ### Anat Image --------------------------------------------------
    BoxLayout:
        id: subjAnatWidget
        padding: [10, 5]
        spacing: 10
        size_hint: (1, .8)
        Label:
            size_hint_x: .3
            text_size: self.size
            color: root.textColor if transformMaskToFuncCheckbox.active else root.disabledTextColor
            text: 'hi-res ANAT: '
            halign: 'right'
            valign: 'middle'
        FilePathInputField:
            multiline: False
            id: subjAnatInput
            size_hint_x: .7
            text: root.GUI_settings.subjAnat
            halign: 'left'
            on_text: root.GUI_settings.subjAnat = subjAnatInput.text
            write_tab: False
            font_size: 28
            padding: [15,15]
            disabled: not transformMaskToFuncCheckbox.active
        Button:
            id: 'subjAnatButton'
            size_hint: (None, None)
            size: (65,65)
            spacing: 15
            padding: (15,15)
            background_normal: root.setupGUI_dir + '/images/openFileBrowser.png'
            allow_stretch: False
            on_release: root.launchFileBrowser(loadFunc=root.setAnatFile)
            disabled: not transformMaskToFuncCheckbox.active
    StackLayout:
        orientation: "rl-tb"
        padding: 15,0
        CheckBox:
            id: skullStripCheckbox
            size: 250,15
            size_hint: None, None
            state: 'down' if root.GUI_settings.skullStrip else 'normal'
            on_active: root.setSkullStrip()
            disabled: not transformMaskToFuncCheckbox.active
        Label:
            text: 'skull strip?'
            size: 15, 15
            size_hint: None, None
            color: root.textColor if transformMaskToFuncCheckbox.active else root.disabledTextColor
            halign: "left"





    ### MNI Standard --------------------------------------------------
    BoxLayout:
        id: MNI_standardWidget
        padding: [10, 5]
        spacing: 10
        size_hint: (1, .8)
        Label:
            size_hint_x: .3
            text_size: self.size
            color: root.textColor if transformMaskToFuncCheckbox.active else root.disabledTextColor
            text: 'MNI standard: '
            halign: 'right'
            valign: 'middle'
        FilePathInputField:
            multiline: False
            id: MNI_standardInput
            size_hint_x: .7
            text: root.GUI_settings.MNI_standard
            halign: 'left'
            on_text: root.GUI_settings.MNI_standard = MNI_standardInput.text
            write_tab: False
            font_size: 28
            padding: [15,15]
            disabled: not transformMaskToFuncCheckbox.active
        Button:
            id: 'MNI_standardButton'
            size_hint: (None, None)
            size: (65,65)
            spacing: 15
            padding: (15,15)
            background_normal: root.setupGUI_dir + '/images/openFileBrowser.png'
            allow_stretch: False
            on_release: root.launchFileBrowser(loadFunc=root.setMNI_standard, path=root.MNI_standardsDir)
            disabled: not transformMaskToFuncCheckbox.active


    ### Mask Path --------------------------------------------------
    BoxLayout:
        id: MNI_maskWidget
        padding: [10, 5]
        spacing: 10
        size_hint: (1, .8)
        Label:
            size_hint_x: .3
            text_size: self.size
            color: root.textColor if transformMaskToFuncCheckbox.active else root.disabledTextColor
            text: 'MNI mask: '
            halign: 'right'
            valign: 'middle'
        FilePathInputField:
            multiline: False
            id: MNI_maskInput
            size_hint_x: .7
            text: root.GUI_settings.MNI_mask
            halign: 'left'
            on_text: root.GUI_settings.MNI_mask = MNI_maskInput.text
            write_tab: False
            font_size: 28
            padding: [15,15]
            disabled: not transformMaskToFuncCheckbox.active
        Button:
            id: 'MNI_maskButton'
            size_hint: (None, None)
            size: (65,65)
            spacing: 15
            padding: (15,15)
            background_normal: root.setupGUI_dir + '/images/openFileBrowser.png'
            allow_stretch: False
            on_release: root.launchFileBrowser(loadFunc=root.setMNI_mask, path=root.masksDir)
            disabled: not transformMaskToFuncCheckbox.active


    ### Output Name
    BoxLayout:
        padding: [10, 5]
        spacing: 10
        size_hint: (1, .8)
        Label:
            size_hint_x: .31
            text_size: self.size
            color: root.textColor if transformMaskToFuncCheckbox.active else root.disabledTextColor
            text: 'Output Prefix: '
            halign: 'right'
            valign: 'middle'
        FilePathInputField:
            size_hint_x: .62
            id: outputPrefixWidget
            text: root.GUI_settings.outputPrefix
            write_tab: False
            disabled: not transformMaskToFuncCheckbox.active
            on_text:root.GUI_settings.outputPrefix = outputPrefixWidget.text
            font_size: 28
            padding: [15,15]
        BoxLayout:
            size_hint_x: .2

    ### Submit Box
    Widget:
        id: separator
        size_hint_y: None
        height: 3
        canvas:
            Color:
                rgb:.5, 0.5, 0.5
            Rectangle:
                pos: 50, separator.center_y
                size: separator.width-60, 2

    BoxLayout:
        padding: [150, 0]
        spacing: 10
        Button:
            text: 'Submit'
            on_release: root.submitGUI()


### Generic Load File Dialog Window #################################
<LoadFileDialog>:
    BoxLayout:
        font_size: '10sp'
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            path: root.path
            filters: root.fileFilter
            font_name: 'Roboto-Bold'

        BoxLayout:
            size_hint_y: None
            height: 50
            Button:
                text: "select"
                on_release: root.loadFunc(filechooser.path, filechooser.selection)
            Button:
                text: "Cancel"
                on_release: root.cancelFileChooser()


### Error Notification Pop-up Window #################################
<ErrorNotification>:
    BoxLayout:
        Label:
            text_size: self.size
            valign: 'top'
            text: root.errorMsg
